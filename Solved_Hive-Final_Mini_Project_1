This is a real time dataset of the ineuron technical consultant team. You have to perform hive analysis on this given dataset.
Download Dataset 1 - https://drive.google.com/file/d/1WrG-9qv6atP-W3P_-gYln1hHyFKRKMHP/view
Download Dataset 2 - https://drive.google.com/file/d/1-JIPCZ34dyN6k9CqJa-Y8yxIGq6vTVXU/view
Note: both files are csv files.

1. Create a schema based on the given dataset.

#SCHEMA FOR AgentLogingReport.csv

hive> use projects;
    > create table agentlogingreport
    > (
    > sl_no int,
    > agent_name string,
    > date string,
    > login_time string,
    > logout_time string,
    > duration string
    > )
    > row format delimited
    > fields terminated by ','
    > tblproperties ("skip.header.line.count"="1");

#SCHEMA FOR AgentPerformance.csv

hive> create table agentperformance
    > (
    > sl_no int,
    > date string,
    > agent_name string,
    > total_chats int,
    > avg_response_time string,
    > avg_resolution_time string,
    > avg_rating float,
    > total_feedback int
    > )
    > row format delimited
    > fields terminated by ','
    > tblproperties ("skip.header.line.count"="1");


2. Dump the data inside the hdfs in the given schema location.

#FOR TABLE agentlogingreport

hive> load data local inpath 'file:///tmp/agentlogingreport.csv' into table agentlogingreport;

hive> insert overwrite table agentlogingreport
    > select sl_no,
    > agent_name,
    > from_unixtime(unix_timestamp(date,'dd-MMM-yy'),'yyyy-MM-dd'),
    > from_unixtime(unix_timestamp(concat(date,login_time),'dd-MMM-yyHH:mm:ss'),'yyyy-MM-dd HH:mm:ss'),
    > from_unixtime(unix_timestamp(concat(date,logout_time),'dd-MMM-yyHH:mm:ss'),'yyyy-MM-dd HH:mm:ss'),
    > from_unixtime(unix_timestamp(concat(date,duration),'dd-MMM-yyHH:mm:ss'),'yyyy-MM-dd HH:mm:ss')
    > from agentlogingreport;

#FOR TABLE agentperformance

hive> load data local inpath 'file:///tmp/agentperformance.csv' into table agentperformance;

hive> insert overwrite table agentperformance
    > select sl_no,
    > from_unixtime(unix_timestamp(date,'M/dd/yyyy'),'yyyy-MM-dd'),
    > agent_name,
    > total_chats,
    > from_unixtime(unix_timestamp(concat(date,avg_response_time),'M/dd/yyyyHH:mm:ss'),'yyyy-MM-dd HH-mm-ss'),
    > from_unixtime(unix_timestamp(concat(date,avg_resolution_time),'M/dd/yyyyHH:mm:ss'),'yyyy-MM-dd HH-mm-ss'),
    > avg_rating,
    > total_feedback
    > from agentperformance;

3. List of all agents' names.

SELECT DISTINCT agent_name FROM agentperformance;


OUTPUT:

agent_name
Abhishek
Aditya
Aditya Shinde
Aditya_iot
Amersh
Ameya Jain
Anirudh
Ankit Sharma
Ankitjha
Anurag Tiwari
Aravind
Ashad Nasim
Ashish
Ayushi Mishra
Bharath
Boktiar Ahmed Bappy
Chaitra K Hiremath
Deepranjan Gupta
Dibyanshu
Harikrishnan Shaji
Hitesh Choudhary
Hrisikesh Neogi
Hyder Abbas
Ineuron Intelligence
Ishawant Kumar
Jawala Prakash
Jayant Kumar
Jaydeep Dixit
Khushboo Priya
Madhulika G
Mahak
Mahesh Sarade
Maitry
Maneesh
Manjunatha A
Mithun S
Mukesh
Mukesh Rao
Muskan Garg
Nandani Gupta
Nishtha Jain
Nitin M
Prabir Kumar Satapathy
Prateek _iot
Prerna Singh
Rishav Dash
Rohan
Saif Khan
Saikumarreddy N
Samprit
Sandipan Saha
Sanjeev Kumar
Sanjeevan
Saurabh Shukla
Shiva Srivastava
Shivan K
Shivan_S
Shivananda Sonwane
Shubham Sharma
Sowmiya Sivakumar
Spuri
Sudhanshu Kumar
Suraj S Bilgi
Swati
Tarun
Uday Mishra
Vasanth P
Vivek
Wasim
Zeeshan


4. Find out agent average rating.

SELECT agent_name, ROUND(AVG(avg_rating),2) AS avg_rating 
FROM agentperformance 
GROUP BY agent_name;

OUTPUT:

agent_name      avg_rating
Abhishek        0.0
Aditya  0.0
Aditya Shinde   1.8
Aditya_iot      2.35
Amersh  0.0
Ameya Jain      2.22
Anirudh         0.64
Ankit Sharma    0.0
Ankitjha        0.27
Anurag Tiwari   0.18
Aravind         2.18
Ashad Nasim     0.17
Ashish  0.0
Ayushi Mishra   3.48
Bharath         2.98
Boktiar Ahmed Bappy     3.57
Chaitra K Hiremath      0.86
Deepranjan Gupta        2.89
Dibyanshu       0.0
Harikrishnan Shaji      2.64
Hitesh Choudhary        0.0
Hrisikesh Neogi 3.14
Hyder Abbas     0.0
Ineuron Intelligence    0.0
Ishawant Kumar  3.54
Jawala Prakash  3.47
Jayant Kumar    1.07
Jaydeep Dixit   3.17
Khushboo Priya  3.7
Madhulika G     3.5
Mahak   0.1
Mahesh Sarade   2.4
Maitry  2.93
Maneesh         0.17
Manjunatha A    3.59
Mithun S        2.36
Mukesh  0.31
Mukesh Rao      0.26
Muskan Garg     0.71
Nandani Gupta   2.92
Nishtha Jain    3.28
Nitin M 0.0
Prabir Kumar Satapathy  2.51
Prateek _iot    2.44
Prerna Singh    3.23
Rishav Dash     1.43
Rohan   0.0
Saif Khan       0.0
Saikumarreddy N 1.98
Samprit         0.0
Sandipan Saha   0.43
Sanjeev Kumar   3.38
Sanjeevan       0.0
Saurabh Shukla  0.56
Shiva Srivastava        0.94
Shivan K        2.84
Shivan_S        0.14
Shivananda Sonwane      4.23
Shubham Sharma  3.23
Sowmiya Sivakumar       1.26
Spuri   0.0
Sudhanshu Kumar 0.33
Suraj S Bilgi   0.31
Swati   2.42
Tarun   0.05
Uday Mishra     0.0
Vasanth P       0.0
Vivek   0.5
Wasim   2.4
Zeeshan         2.29


5. Total working days for each agents 

SELECT agent_name,
COUNT(DISTINCT date) AS total_working_days 
FROM agentlogingreport 
GROUP BY agent_name;

agent_name      total_working_days
NULL    0
Aditya Shinde   1
Aditya_iot      8
Amersh  2
Ameya Jain      7
Ankitjha        2
Anurag Tiwari   10
Aravind 7
Ayushi Mishra   9
Bharath 8
Boktiar Ahmed Bappy     9
Chaitra K Hiremath      7
Deepranjan Gupta        10
Dibyanshu       9
Harikrishnan Shaji      9
Hrisikesh Neogi 9
Hyder Abbas     2
Ineuron Intelligence    1
Ishawant Kumar  11
Jawala Prakash  9
Jaydeep Dixit   7
Khushboo Priya  8
Madhulika G     8
Mahesh Sarade   8
Maitry  5
Manjunatha A    7
Mithun S        8
Mukesh  2
Muskan Garg     6
Nandani Gupta   9
Nishtha Jain    8
Nitin M 1
Prabir Kumar Satapathy  7
Prateek _iot    11
Prerna Singh    9
Rishav Dash     7
Saikumarreddy N 7
Sanjeev Kumar   9
Saurabh Shukla  4
Shiva Srivastava        8
Shivan K        8
Shivananda Sonwane      10
Shubham Sharma  11
Sowmiya Sivakumar       8
Sudhanshu Kumar 6
Suraj S Bilgi   2
Swati   4
Tarun   1
Wasim   9
Zeeshan 9


6. Total query that each agent have taken 

SELECT agent_name, SUM(total_chats) AS total_query 
FROM agentperformance 
GROUP BY agent_name;

agent_name      total_query
Abhishek        0
Aditya  0
Aditya Shinde   277
Aditya_iot      231
Amersh  0
Ameya Jain      322
Anirudh         81
Ankit Sharma    0
Ankitjha        5
Anurag Tiwari   4
Aravind         366
Ashad Nasim     18
Ashish  0
Ayushi Mishra   514
Bharath         369
Boktiar Ahmed Bappy     452
Chaitra K Hiremath      64
Deepranjan Gupta        493
Dibyanshu       1
Harikrishnan Shaji      381
Hitesh Choudhary        1
Hrisikesh Neogi 578
Hyder Abbas     0
Ineuron Intelligence    0
Ishawant Kumar  338
Jawala Prakash  439
Jayant Kumar    127
Jaydeep Dixit   512
Khushboo Priya  446
Madhulika G     469
Mahak   7
Mahesh Sarade   364
Maitry  542
Maneesh         4
Manjunatha A    413
Mithun S        503
Mukesh  19
Mukesh Rao      5
Muskan Garg     56
Nandani Gupta   560
Nishtha Jain    373
Nitin M 0
Prabir Kumar Satapathy  299
Prateek _iot    190
Prerna Singh    401
Rishav Dash     409
Rohan   0
Saif Khan       0
Saikumarreddy N 364
Samprit         1
Sandipan Saha   30
Sanjeev Kumar   507
Sanjeevan       0
Saurabh Shukla  16
Shiva Srivastava        53
Shivan K        357
Shivan_S        7
Shivananda Sonwane      441
Shubham Sharma  510
Sowmiya Sivakumar       206
Spuri   0
Sudhanshu Kumar 2
Suraj S Bilgi   28
Swati   524
Tarun   22
Uday Mishra     0
Vasanth P       0
Vivek   44
Wasim   433
Zeeshan         542



7. Total Feedback that each agent have received 

SELECT agent_name, SUM(total_feedback) AS total_feedbacks 
FROM agentperformance 
GROUP BY agent_name;

agent_name      total_feedbacks
Abhishek        0
Aditya  0
Aditya Shinde   153
Aditya_iot      131
Amersh  0
Ameya Jain      228
Anirudh         39
Ankit Sharma    0
Ankitjha        3
Anurag Tiwari   3
Aravind         233
Ashad Nasim     9
Ashish  0
Ayushi Mishra   329
Bharath         247
Boktiar Ahmed Bappy     311
Chaitra K Hiremath      37
Deepranjan Gupta        312
Dibyanshu       0
Harikrishnan Shaji      231
Hitesh Choudhary        0
Hrisikesh Neogi 367
Hyder Abbas     0
Ineuron Intelligence    0
Ishawant Kumar  202
Jawala Prakash  250
Jayant Kumar    70
Jaydeep Dixit   305
Khushboo Priya  289
Madhulika G     281
Mahak   5
Mahesh Sarade   216
Maitry  347
Maneesh         3
Manjunatha A    254
Mithun S        364
Mukesh  17
Mukesh Rao      5
Muskan Garg     37
Nandani Gupta   308
Nishtha Jain    257
Nitin M 0
Prabir Kumar Satapathy  222
Prateek _iot    107
Prerna Singh    235
Rishav Dash     264
Rohan   0
Saif Khan       0
Saikumarreddy N 290
Samprit         0
Sandipan Saha   18
Sanjeev Kumar   311
Sanjeevan       0
Saurabh Shukla  8
Shiva Srivastava        46
Shivan K        243
Shivan_S        4
Shivananda Sonwane      263
Shubham Sharma  300
Sowmiya Sivakumar       141
Spuri   0
Sudhanshu Kumar 2
Suraj S Bilgi   15
Swati   302
Tarun   6
Uday Mishra     0
Vasanth P       0
Vivek   20
Wasim   284
Zeeshan         335



8. Agent name who have average rating between 3.5 to 4 

SELECT agent_name, ROUND(AVG(avg_rating),2) 
FROM agentperformance 
WHERE avg_rating BETWEEN 3.5 AND 4 
GROUP BY agent_name;

agent_name      _c1
Aditya Shinde   3.54
Aditya_iot      3.74
Ameya Jain      4.0
Anirudh         3.77
Anurag Tiwari   3.5
Ashad Nasim     4.0
Ayushi Mishra   3.85
Boktiar Ahmed Bappy     3.88
Chaitra K Hiremath      4.0
Deepranjan Gupta        3.68
Harikrishnan Shaji      3.84
Hrisikesh Neogi 3.78
Ishawant Kumar  3.77
Jawala Prakash  3.84
Jayant Kumar    3.76
Jaydeep Dixit   3.98
Khushboo Priya  3.81
Madhulika G     3.86
Mahesh Sarade   3.78
Maitry  3.83
Maneesh         4.0
Manjunatha A    3.87
Mithun S        3.82
Muskan Garg     3.81
Nandani Gupta   3.74
Nishtha Jain    3.78
Prabir Kumar Satapathy  4.0
Prateek _iot    3.75
Prerna Singh    3.8
Rishav Dash     3.79
Sandipan Saha   3.62
Sanjeev Kumar   4.0
Saurabh Shukla  3.67
Shiva Srivastava        4.0
Shivan K        3.98
Shivananda Sonwane      3.62
Shubham Sharma  4.0
Swati   3.76
Wasim   3.84
Zeeshan         3.77


9. Agent name who have rating less than 3.5 

SELECT agent_name, ROUND(AVG(avg_rating),2) 
FROM agentperformance 
GROUP BY agent_name 
HAVING AVG(avg_rating) < 3.5;

agent_name      _c1
Abhishek        0.0
Aditya  0.0
Aditya Shinde   1.8
Aditya_iot      2.35
Amersh  0.0
Ameya Jain      2.22
Anirudh         0.64
Ankit Sharma    0.0
Ankitjha        0.27
Anurag Tiwari   0.18
Aravind         2.18
Ashad Nasim     0.17
Ashish  0.0
Ayushi Mishra   3.48
Bharath         2.98
Chaitra K Hiremath      0.86
Deepranjan Gupta        2.89
Dibyanshu       0.0
Harikrishnan Shaji      2.64
Hitesh Choudhary        0.0
Hrisikesh Neogi 3.14
Hyder Abbas     0.0
Ineuron Intelligence    0.0
Jawala Prakash  3.47
Jayant Kumar    1.07
Jaydeep Dixit   3.17
Madhulika G     3.5
Mahak   0.1
Mahesh Sarade   2.4
Maitry  2.93
Maneesh         0.17
Mithun S        2.36
Mukesh  0.31
Mukesh Rao      0.26
Muskan Garg     0.71
Nandani Gupta   2.92
Nishtha Jain    3.28
Nitin M 0.0
Prabir Kumar Satapathy  2.51
Prateek _iot    2.44
Prerna Singh    3.23
Rishav Dash     1.43
Rohan   0.0
Saif Khan       0.0
Saikumarreddy N 1.98
Samprit         0.0
Sandipan Saha   0.43
Sanjeev Kumar   3.38
Sanjeevan       0.0
Saurabh Shukla  0.56
Shiva Srivastava        0.94
Shivan K        2.84
Shivan_S        0.14
Shubham Sharma  3.23
Sowmiya Sivakumar       1.26
Spuri   0.0
Sudhanshu Kumar 0.33
Suraj S Bilgi   0.31
Swati   2.42
Tarun   0.05
Uday Mishra     0.0
Vasanth P       0.0
Vivek   0.5
Wasim   2.4
Zeeshan         2.29



10. Agent name who have rating more than 4.5 
11. How many feedback agents have received more than 4.5 average
12. average weekly response time for each agent 
13. average weekly resolution time for each agents 
14. Find the number of chat on which they have received a feedback 
15. Total contribution hour for each and every agents weekly basis 
16. Perform inner join, left join and right join based on the agent column and after joining the table export that data into your local system.
17. Perform partitioning on top of the agent column and then on top of that perform bucketing for each partitioning.
